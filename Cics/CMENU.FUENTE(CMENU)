       IDENTIFICATION DIVISION.                                         00010046
       PROGRAM-ID. PGMPRU10.                                            00020046
       DATA DIVISION.                                                   00030046
       FILE SECTION.                                                    00040046
       WORKING-STORAGE SECTION.                                         00050046
       01 CT-CONSTANTES.                                                00060046
          03 CT-MSGO.                                                   00070049
             05 CT-MNS-01             PIC X(72)        VALUE            00080046
                  'ELIJA UNA OPCION.'.                                  00090051
             05 CT-MNS-02             PIC X(72)        VALUE            00100046
                  'DATOS INGRESADOS INCORRECTOS - REINGRESE'.           00110046
             05 CT-MNS-03             PIC X(72)        VALUE            00120046
                  'TIPO Y NÚMERO DOCUMENTO INEXISTENTES - REINGRESE'.   00130046
             05 CT-MNS-04             PIC X(72)        VALUE            00140046
                  'TIPO DE DOCUMENTO INVALIDO'.                         00150046
             05 CT-MNS-05             PIC X(72)        VALUE            00160046
                  'NUMERO DE DOCUMENTO INVALIDO'.                       00170046
             05 CT-MNS-06             PIC X(72)        VALUE            00180046
                  'CLIENTE ENCONTRADO'.                                 00190046
             05 CT-MNS-08             PIC X(72)        VALUE            00200046
                  'PROBLEMA CON ARCHIVO PERSONA'.                       00210046
             05 CT-MNS-09             PIC X(72)        VALUE            00220046
                  'TECLA INVALIDA'.                                     00230046
             05 CT-MNS-EXIT           PIC X(72)        VALUE            00240046
                  'FIN TRANSACCION T210'.                               00250048
             05 CT-MNS-ALTA           PIC X(12)        VALUE            00251048
                  'ENTRO A ALTA'.                                       00252048
             05 CT-MNS-BAJA           PIC X(12)        VALUE            00253048
                  'ENTRO A BAJA'.                                       00254057
             05 CT-MNS-MODIFICACION   PIC X(20)        VALUE            00255049
                  'ENTRO A MODIFICACION'.                               00256048
             05 CT-MNS-CONSULTA       PIC X(17)        VALUE            00257048
                  'ENTRO A CONSULTA'.                                   00258048
             05 CT-MNS-SALIR          PIC X(11)        VALUE            00259048
                  'SALIENDO...'.                                        00259148
          03 CT-DATASET               PIC X(08)        VALUE 'PERSONA'. 00260046
          03 CT-DATASET-LEN           PIC S9(04) COMP  VALUE 160.       00270046
                                                                        00280046
       01 WS-VARIABLES.                                                 00290046
          03 WS-MAP-00                PIC X(07)        VALUE 'MAP0210'. 00300048
          03 WS-MAPSET-00             PIC X(07)        VALUE 'MAP0210'. 00310048
          03 WS-LONG                  PIC S9(04) COMP.                  00320046
          03 WS-ABSTIME               PIC S9(16) COMP  VALUE +0.        00330046
          03 WS-FECHA                 PIC X(10)        VALUE SPACES.    00340046
          03 WS-SEP-DATE              PIC X            VALUE '/'.       00350046
          03 WS-HORA                  PIC X(08)        VALUE SPACES.    00360046
          03 WS-SEP-HOUR              PIC X            VALUE ':'.       00370046
          03 WS-RESP                  PIC S9(04) COMP.                  00380046
          03 WS-ERR                   PIC X(15).                        00390046
          03 SW-CONFIRMAR             PIC X            VALUE 'Y'.       00400046
          03 WS-NORMAL                PIC X            VALUE '*'.       00410046
          03 WS-ENTER                 PIC X            VALUE ' '.       00420046
       01 WS-MENS                     PIC X(72)        VALUE SPACES.    00421048
                                                                        00430046
       01 WS-USER-AUXILIAR.                                             00440046
          03 WS-USER-DATA.                                              00450046
             05 WS-USER-TIPDOC        PIC X(02).                        00460046
             05 WS-USER-NRODOC        PIC 9(11).                        00470046
          03 WS-TIP-DOC               PIC X(02).                        00480046
             88 WS-TIP-DOC-BOOLEAN                     VALUE 'DU'       00490046
                                                             'PA'       00500046
                                                             'PE'.      00510046
          03 FILLER                   PIC X(5).                         00520046
       01  REG-PERSONA.                                                 00530046
           03  PER-TIP-DOC            PIC X(02).                        00540046
           03  PER-NRO-DOC            PIC 9(11).                        00550046
           03  PER-CLI-NRO            PIC 9(03).                        00560046
           03  PER-NOMAPE             PIC X(30).                        00570046
           03  PER-CLI-AAAAMMDD       PIC 9(08).                        00580046
           03  PER-DIRECCION          PIC X(30).                        00590046
           03  PER-LOCALIDAD          PIC X(15).                        00600046
           03  PER-EMAIL              PIC X(30).                        00610046
           03  PER-TELEFONO           PIC X(15).                        00620046
           03  PER-SEXO               PIC X    .                        00630046
           03  PER-NRO-SUCURSAL       PIC 9(03).                        00640046
           03  FILLER                 PIC X(12).                        00650046
                                                                        00660046
       COPY MAP0210.                                                    00670048
       COPY DFHBMSCA.                                                   00680046
       COPY DFHAID.                                                     00690046
                                                                        00701047
       PROCEDURE DIVISION.                                              00710046
       MAIN-PROGRAM.                                                    00720046
           PERFORM 1000-I-INICIO                                        00730046
              THRU 1000-I-INICIO                                        00740046
           PERFORM 2000-I-PROCESO                                       00750046
              THRU 2000-F-PROCESO.                                      00760046
                                                                        00770046
       1000-I-INICIO.                                                   00780046
           IF EIBCALEN = 0 OR DFHAID = DFHPF3                           00790075
               MOVE LENGTH OF MAP0210O TO WS-LONG                       00800048
               INITIALIZE MAP0210I                                      00810048
               PERFORM 7000-I-TIME                                      00820046
                  THRU 7000-F-TIME                                      00830046
               PERFORM 9800-I-BLOQUEAR                                  00831069
                  THRU 9800-F-BLOQUEAR                                  00832069
               MOVE 'T210-MAP0210' TO T210O                             00840049
               MOVE CT-MNS-01      TO MSGO                              00850049
               EXEC CICS                                                00860046
                    SEND MAP (WS-MAP-00)                                00870046
                         MAPSET (WS-MAPSET-00)                          00880046
                         FROM (MAP0210O)                                00890048
                         LENGTH (WS-LONG)                               00900046
                         ERASE                                          00910046
                         FREEKB                                         00920046
                         RESP (WS-RESP)                                 00930046
               END-EXEC                                                 00940046
               IF WS-RESP = DFHRESP(NORMAL)                             00950055
      *          PERFORM 9999-I-FINAL                                   00960055
      *             THRU 9999-F-FINAL                                   00970055
                 CONTINUE                                               00971055
               ELSE                                                     00980046
                 MOVE 'ERROR EIBCALEN' TO WS-ERR                        00990046
                 EXEC CICS SEND TEXT FROM (WS-ERR) END-EXEC             01000046
                 PERFORM 9000-I-PF12                                    01010046
                    THRU 9000-F-PF12.                                   01020046
       1000-F-INICIO. EXIT.                                             01030046
                                                                        01040046
       2000-I-PROCESO.                                                  01050046
               PERFORM 7000-I-TIME                                      01060046
                  THRU 7000-F-TIME.                                     01070054
               MOVE LENGTH OF MAP0210O TO WS-LONG.                      01080054
               EXEC CICS                                                01090046
                    RECEIVE MAP    (WS-MAP-00)                          01100046
                            MAPSET (WS-MAPSET-00)                       01110046
                            INTO   (MAP0210I)                           01120048
                            RESP   (WS-RESP)                            01130046
               END-EXEC.                                                01140054
                 PERFORM 2600-I-PULSAR-TECLA-MSJ                        01160048
                    THRU 2600-F-PULSAR-TECLA-MSJ.                       01170056
       2000-F-PROCESO. EXIT.                                            01230046
                                                                        01240046
                                                                        01610046
       2600-I-PULSAR-TECLA-MSJ.                                         01611248
                                                                        01612048
                                                                        01613048
             EVALUATE EIBAID                                            01613148
                                                                        01613248
                WHEN DFHPF1                                             01613348
                  EXEC CICS                                             01613461
                    SEND CONTROL ERASE                                  01613561
                  END-EXEC                                              01613662
                  EXEC CICS XCTL                                        01613761
                    PROGRAM  ('PGMALT10')                               01613863
                  END-EXEC                                              01613962
                  EXEC CICS                                             01614161
                  RETURN                                                01614261
                  END-EXEC                                              01614362
                                                                        01614461
                WHEN DFHPF2                                             01614948
                  EXEC CICS                                             01615072
                    SEND CONTROL ERASE                                  01615172
                  END-EXEC                                              01615272
                  EXEC CICS XCTL                                        01615372
                    PROGRAM  ('PGMBAJ10')                               01615473
                  END-EXEC                                              01615572
                  EXEC CICS                                             01615672
                  RETURN                                                01615772
                  END-EXEC                                              01615872
                WHEN DFHPF3                                             01615966
                      EXEC CICS                                         01616065
                      SEND CONTROL                                      01616169
                      ERASE                                             01616269
                      END-EXEC                                          01616365
                      EXEC CICS                                         01616465
                      XCTL PROGRAM ('PGMMOD10')                         01616565
                      END-EXEC                                          01616665
                      EXEC CICS                                         01616765
                      RETURN                                            01616865
                      END-EXEC                                          01616965
                WHEN DFHPF4                                             01617048
                      EXEC CICS                                         01617158
                      SEND CONTROL                                      01617269
                      ERASE                                             01617369
                      END-EXEC                                          01617459
                      EXEC CICS                                         01617558
                      XCTL PROGRAM ('PGMPRU10')                         01617658
                      END-EXEC                                          01617759
                      EXEC CICS                                         01617858
                      RETURN                                            01617958
                      END-EXEC                                          01618059
                 MOVE           CT-MNS-CONSULTA      TO WS-MENS         01618148
                 MOVE LENGTH OF WS-MENS              TO WS-LONG         01618248
                 PERFORM        3100-I-ENVIAR-MSJ                       01618348
                 THRU           3100-F-ENVIAR-MSJ                       01618448
                WHEN DFHPF12                                            01618548
                  PERFORM       9000-I-PF12                             01618751
                  THRU          9000-F-PF12                             01618851
                WHEN OTHER                                              01618948
                 MOVE CT-MNS-09 TO MSGO                                 01619067
                                                                        01619148
                 MOVE LENGTH OF MAP0210O TO WS-LONG                     01619267
                 MOVE WS-MAP-00          TO T210O                       01619367
                 PERFORM 7000-I-TIME                                    01619466
                    THRU 7000-F-TIME                                    01619568
                 PERFORM 9800-I-BLOQUEAR                                01619669
                    THRU 9800-F-BLOQUEAR                                01619769
                  EXEC       CICS SEND                                  01619866
                  MAP        (WS-MAP-00)                                01619967
                  MAPSET     (WS-MAPSET-00)                             01620067
                  FROM       (MAP0210O)                                 01620167
                  LENGTH     (WS-LONG)                                  01620267
                  RESP       (WS-RESP)                                  01620366
                  ERASE                                                 01620466
                  FREEKB                                                01620566
                  END-EXEC                                              01620668
           IF WS-RESP = DFHRESP(NORMAL) THEN                            01620766
             PERFORM 9999-I-FINAL                                       01620866
                THRU 9999-F-FINAL                                       01620966
           ELSE                                                         01621066
             MOVE 'ERROR 3000-ENTER' TO WS-ERR                          01621166
             EXEC CICS SEND TEXT FROM (WS-ERR) END-EXEC                 01621266
             PERFORM 9000-I-PF12                                        01621366
                THRU 9000-I-PF12                                        01621466
           END-IF                                                       01621566
                                                                        01621668
             END-EVALUATE.                                              01623366
                                                                        01623466
       2600-F-PULSAR-TECLA-MSJ. EXIT.                                   01623566
                                                                        01623666
       3100-I-ENVIAR-MSJ.                                               01623766
                                                                        01623866
           EXEC CICS                                                    01623966
                 SEND CONTROL ERASE                                     01624066
           END-EXEC.                                                    01624166
                                                                        01624266
           EXEC CICS                                                    01624566
                SEND TEXT                                               01624666
                FROM  (WS-MENS)                                         01624766
                LENGTH(WS-LONG)                                         01624866
                ERASE                                                   01624966
           END-EXEC.                                                    01625066
                                                                        01625166
           EXEC CICS                                                    01625266
                RETURN                                                  01625366
           END-EXEC.                                                    01625466
                                                                        01625566
       3100-F-ENVIAR-MSJ. EXIT.                                         01626066
                                                                        02700046
       7000-I-TIME.                                                     02710046
           EXEC CICS ASKTIME                                            02720046
             ABSTIME (WS-ABSTIME)                                       02730046
           END-EXEC.                                                    02740046
           EXEC CICS FORMATTIME                                         02750046
             ABSTIME (WS-ABSTIME)                                       02760046
             DDMMYYYY (WS-FECHA) DATESEP(WS-SEP-DATE)                   02770046
             TIME (WS-HORA) TIMESEP(WS-SEP-HOUR)                        02780046
           END-EXEC.                                                    02790046
                                                                        02791076
           MOVE WS-FECHA TO FECHA1O.                                    02800047
                                                                        02801076
       7000-F-TIME. EXIT.                                               02810046
                                                                        02820046
       9000-I-PF12.                                                     02830046
                                                                        02831076
               EXEC CICS                                                02840046
                    SEND CONTROL ERASE                                  02850046
               END-EXEC                                                 02860046
               EXEC CICS                                                02870046
                    SEND TEXT                                           02880046
                         FROM (CT-MNS-EXIT)                             02890046
               END-EXEC                                                 02900046
               EXEC CICS                                                02910046
                    RETURN                                              02920046
                                                                        02921076
               END-EXEC.                                                02930046
                                                                        02931076
       9000-F-PF12. EXIT.                                               02940046
                                                                        02950046
       9800-I-BLOQUEAR.                                                 02951069
                                                                        02952076
           MOVE DFHBMPRO TO FECHA1A                                     02954069
           MOVE DFHBMPRO TO T210A                                       02954170
           MOVE DFHBMPRO TO MSGA.                                       02955069
                                                                        02955176
       9800-F-BLOQUEAR. EXIT.                                           02956069
                                                                        02957076
       9999-I-FINAL.                                                    02960046
                                                                        02961076
           EXEC CICS                                                    02970046
             RETURN                                                     02980046
             TRANSID  ('T210')                                          02990048
            END-EXEC.                                                   03010046
                                                                        03011076
       9999-F-FINAL. EXIT.                                              03020046
